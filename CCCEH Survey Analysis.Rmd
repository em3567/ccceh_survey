---
title: "CCCEH Survey Analysis"
author: "Eleanor Medley"
date: "7/8/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages}
library(readr)
library(tidyverse)
library(dplyr)
library(labelled)

```
```{r import}
# import first data set
practice_data <- read.csv("Responses3.csv")
view(practice_data)

# ESTABLISH CODEBOOK!

# get rid of first row of observations (the questions)
practice_data <- practice_data[-1,]
view(practice_data)

# add a column that indicates the source
practice_data <- practice_data %>% mutate(data_source = "YMCA")
glimpse(practice_data)

# import next data set (for now, I'll just re-import the same one)
practice_data2 <- read.csv("Responses3.csv")
view(practice_data2)

# get rid of first row of observations (the questions)
practice_data2 <- practice_data2[-1,]
view(practice_data2)

# add a column that indicates the source (different from the first data set)
practice_data2 <- practice_data2 %>% mutate(data_source = "Scouts")
glimpse(practice_data2)

# Merge the data sets
all_practice_data <- rbind(practice_data, practice_data2)
view(all_practice_data)
# NOTE: numbers on the far left are automatically assigned by R and are weird

```
```{r, motivation}

# For each child 12 and under, rate on a scale of 1-10 how much they wear children's makeup and body products as play versus for beautification?

# First, need to convert scores from chr to number
all_practice_data$X1_Q31_1 <- as.numeric(all_practice_data$X1_Q31_1)
all_practice_data$X2_Q31_1 <- as.numeric(all_practice_data$X2_Q31_1)
all_practice_data$X3_Q31_1 <- as.numeric(all_practice_data$X3_Q31_1)
all_practice_data$X4_Q31_1 <- as.numeric(all_practice_data$X4_Q31_1)
all_practice_data$X5_Q31_1 <- as.numeric(all_practice_data$X5_Q31_1)
glimpse(all_practice_data)

# Create a sub dataset that is just the rating questions
practice_data_rating <- all_practice_data %>% select(X1_Q31_1, X2_Q31_1, X3_Q31_1, X4_Q31_1, X5_Q31_1)
view(practice_data_rating)

# Summarise mean by child
rating_means <- practice_data_rating %>% summarise_all(mean, na.rm = TRUE)
print(rating_means)

# Summarise overall mean
rating_means <- rating_means %>% rowwise() %>% mutate(overall_mean = mean(c(X1_Q31_1, X2_Q31_1, X3_Q31_1, X4_Q31_1, X5_Q31_1)))
print(rating_means)

# Summarise mean by age group (Q12 Child Age)

# Start by adding a new variable of child age groups:
# 0 - 3 (Infants)
# 4 - 6 (Preschool and Kindergarten)
# 7 - 9 (Early Elementary)
# 10 - 12 (Late Elementary/Early Middle School)

# Convert age to a number
all_practice_data$X1_Q12 <- as.numeric(all_practice_data$X1_Q12)
all_practice_data$X2_Q12 <- as.numeric(all_practice_data$X2_Q12)
all_practice_data$X3_Q12 <- as.numeric(all_practice_data$X3_Q12)
all_practice_data$X4_Q12 <- as.numeric(all_practice_data$X4_Q12)
all_practice_data$X5_Q12 <- as.numeric(all_practice_data$X5_Q12)
glimpse(all_practice_data)

all_practice_data <- all_practice_data %>% 
  mutate(child1_age_group = if_else(X1_Q12 <= 3, "0-3", 
                            if_else(X1_Q12 <= 6, "4-6", 
                            if_else(X1_Q12 <= 9, "7-9",
                            if_else(X1_Q12 <= 12, "10-12", NA_character_)))))

all_practice_data <- all_practice_data %>% 
  mutate(child1_age_group = if_else(X2_Q12 <= 3, "0-3", 
                            if_else(X2_Q12 <= 6, "4-6", 
                            if_else(X2_Q12 <= 9, "7-9",
                            if_else(X2_Q12 <= 12, "10-12", NA_character_)))))

all_practice_data <- all_practice_data %>% 
  mutate(child1_age_group = if_else(X3_Q12 <= 3, "0-3", 
                            if_else(X3_Q12 <= 6, "4-6", 
                            if_else(X3_Q12 <= 9, "7-9",
                            if_else(X3_Q12 <= 12, "10-12", NA_character_)))))

all_practice_data <- all_practice_data %>% 
  mutate(child1_age_group = if_else(X4_Q12 <= 3, "0-3", 
                            if_else(X4_Q12 <= 6, "4-6", 
                            if_else(X4_Q12 <= 9, "7-9",
                            if_else(X4_Q12 <= 12, "10-12", NA_character_)))))

all_practice_data <- all_practice_data %>% 
  mutate(child1_age_group = if_else(X5_Q12 <= 3, "0-3", 
                            if_else(X5_Q12 <= 6, "4-6", 
                            if_else(X5_Q12 <= 9, "7-9",
                            if_else(X5_Q12 <= 12, "10-12", NA_character_)))))


```

